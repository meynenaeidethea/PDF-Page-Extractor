# Проект по вырезанию страниц из PDF

## Назначение

Эта утилита позволяет выделять указанные пользователем страницы из существующего PDF‑файла и сохранять результат в отдельный документ. В основе проекта лежит библиотека `pypdf`.

Программа реализована в виде консольного скрипта и предоставляет интерфейс через командную строку. Для выполнения требуется Python 3.12 или выше. Ниже описаны требования, установка, структура проекта и примеры использования.

## Структура проекта

```text
project/
├── README.md             # данное описание
├── docs/                 # дополнительная документация и исходный PDF
├── src/                  # исходный код Python
│   ├── __init__.py
│   └── extract_pages.py  # основной модуль вырезания
├── input_pdfs/           # каталог с исходными PDF (отдельно от кода)
├── output_pdfs/          # каталог для сохранения результатов
├── tests/                # модульные тесты (pytest)
├── requirements.txt      # список зависимостей
└── .gitignore            # файлы/каталоги, которые не нужно отслеживать
```

## Требования и установка

1.  Проект работает корректно для версии Python ≥ 3.12. Для изоляции окружения рекомендуется использовать `venv`:

    ```bash
    python3 -m venv .venv
    source .venv/bin/activate   # Linux/macOS
    .venv\Scripts\activate      # Windows
    ```

2.  Установите зависимости. 

    ```bash
    pip install -r requirements.txt
    ```

3.  Поместите исходные PDF‑файлы в каталог `input_pdfs/`. По умолчанию программа ищет файлы именно там.

## Использование

Активируйте виртуальное окружение и запустите утилиту из корня проекта. Основные параметры командной строки:

- `--input` / `-i` — имя исходного PDF‑файла. Файл должен лежать в каталоге `input_pdfs/` и иметь расширение `.pdf`. При указании абсолютного пути программа использует его напрямую.
- `--pages` / `-p` — перечень страниц. Поддерживаются диапазоны (`start-end`), одиночные номера и комбинации нескольких диапазонов и номеров через запятую, например `"1-3,5,7-9"`. Нумерация начинается с 1.
- `--output` / `-o` — имя создаваемого файла. Если параметр не указан, имя формируется автоматически из названия исходного файла с суффиксом `_pages.pdf`.

Пример вызова:

```bash
python src/extract_pages.py --input book.pdf --pages "8-16" --output my_selection.pdf
```

Этот пример вырежет страницы 8—16 (включительно) из файла `book.pdf` и сохранит результат в `output_pdfs/my_selection.pdf`. Можно комбинировать диапазоны и одиночные номера: `1-3,5,7-9`.

## Формат `--pages`

Значение параметра `--pages` представляет собой строку с перечнем номеров страниц. Допускаются:

- Диапазоны (`start-end`), например `8-16` или `1-1`.
- Одиночные номера (`5`).
- Комбинации нескольких диапазонов и одиночных номеров через запятую (`1-3,5,7-9`).

Указанные номера считаются 1‑индексированными, но библиотека `pypdf` нумерует страницы с нуля, поэтому программа корректирует номера при вырезании. Повторяющиеся значения игнорируются автоматически. Если начало диапазона больше конца, указан ноль или отрицательное число, программа завершится с ошибкой.

## Тестирование

Для автоматизации проверки используется `pytest`. Модульные тесты находятся в директории `tests/`. Тесты создают временные PDF‑файлы при помощи `book.ab`, вызывают CLI через `CliRunner` из `click.testing` и проверяют, что утилита корректно обрабатывает как правильные, так и ошибочные сценарии. Чтобы запустить тесты, выполните:

```bash
pytest
```

## TODO

В проект планируется добавлить графический интерфейс и возможность работы с зашифрованными файлами.
